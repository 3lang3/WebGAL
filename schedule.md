# webgal重构日志

### 2022/02/19
做了项目的初始提交，但是由于本人平时需要工作，加上对于react并不十分熟悉，所以进度比较缓慢。

初步完成了从MVC到MVVM的重构，但是在状态管理上遇到了一些阻力，由于react的单向数据流和更新数据采用的是简单的浅比较，所以性能优化和代码拆分是一件比较痛苦的事情。想象一下，无尽的组件拆分，useState,参数传入。。。Oh, God! Please help me!!

经过一段时间的权衡，决定使用Reto来做状态管理。

### 2022/02/20
在做脚本解析，老实说，这脚本不是很严谨，随心所欲，有点让人头疼

### 2022/02/23
在写变量系统时发现，语法过于粗糙，所以加入了计算器，但仅能支持整数简单运算

### 2022/02/26
使用reto的时候遇到一个问题，在store中使用自定义hooks会导致内外状态更新不一致，很神奇的问题

### 2022/02/27
好吧我发现状态不一致的问题是因为定时器的状态没有更新，使用ref代替后问题解决

### 2022/03/02
基本完成了重构，还差保存和导出存档，以及动画效果，和新语法兼容

### 2022/03/03
遇到个奇怪的问题，pako的版本为2.0.4时存储数据会无法读取，`pako.esm.mjs:6635 Uncaught incorrect header check`，错误信息如上，版本降低以后反而没事了